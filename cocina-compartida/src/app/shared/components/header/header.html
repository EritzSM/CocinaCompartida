<header class="main-header">
    <div class="header-content">
        <div routerLink="/home" class="logo">
            CocinaCompartida춽
        </div>

           <div class="search-section">
               <div class="search-box" [class.suggestions-open]="showSuggestions()">
                   <input
                       type="text"
                       [(ngModel)]="searchQuery"
                       (input)="onSearchInput()"
                       (keydown)="onKeyDown($event)"
                       (blur)="hideSuggestions()"
                       placeholder="Buscar recetas..."
                       class="search-input"
                       autocomplete="off"
                   />
                   <i class="fas fa-search search-icon" (click)="onSearch()"></i>

                   <!-- Suggestions dropdown -->
                   <div class="suggestions-dropdown" *ngIf="showSuggestions() && searchService.suggestions().length > 0">
                       <div
                           class="suggestion-item"
                           *ngFor="let recipe of searchService.suggestions(); let i = index"
                           [class.selected]="i === selectedSuggestionIndex()"
                           (mousedown)="selectSuggestion(recipe)"
                       >
                           <div class="suggestion-content">
                               <strong>{{ recipe.name }}</strong>
                               <span class="suggestion-category">{{ recipe.category }}</span>
                           </div>
                           <small class="suggestion-author">por {{ recipe.user.username }}</small>
                       </div>
                   </div>
               </div>

               <div class="sort-options">
                   <select [(ngModel)]="sortOption" (change)="onSortChange()">
                       <option value="recent">M치s recientes</option>
                       <option value="oldest">M치s antiguas</option>
                       <option value="likes">M치s likes</option>
                   </select>
               </div>
           </div>

        <nav class="main-nav">
            <a routerLink="/explore" class="nav-link">Explorar</a>
            <div class="categories-menu">
                <select [(ngModel)]="selectedCategory" (ngModelChange)="onCategoryChange($event)" class="category-select">
                    <option *ngFor="let cat of categories" [value]="cat.id">{{ cat.name }}</option>
                </select>
            </div>
        </nav>

        <div class="auth-section">
            <!-- Mostrar si NO est치 logueado -->
            <a *ngIf="!authService.isLoged()" routerLink="/login" class="action-btn">
                Iniciar Sesi칩n
            </a>
            
            <!-- Mostrar si EST츼 logueado -->
            <div *ngIf="authService.isLoged()" class="user-menu">
                <!-- 游녢 Usa el m칠todo getCurrentUsername() en lugar de la se침al -->
                <span routerLink="/profile" class="welcome-text">Hola, {{ authService.currentUsername() }}</span>
                <button routerLink="/home "(click)="authService.logout()" class="logout-btn">Cerrar Sesi칩n</button>
            </div>
        </div>
    </div>
</header>